{% extends 'base/logged_out.html' %}
{% load i18n %}
{% load widget_tweaks %}

{% block title %}{% trans "Login" %}{% endblock title %}

{% block pageheader %}{% trans "Welcome to Gig-o-Matic!" %}{% endblock pageheader %}

{% block pagecontent %}
{% include 'base/messages.html' %}

{% if form.errors %}
<div class="mb-4">
    <strong>{% trans "Login failed!" %}</strong> {% trans "Check your credentials and try again." %}
</div>
{% endif %}

<form class="form" role="form" action= "{% url 'login' %}" method="POST">
    {% csrf_token %}
    <div class="form-group row">
        <div class="col-form-label col-lg-3 text-lg-right">{{ form.username.label_tag}}</div>
        <div class="col-lg-8 col-12">{% render_field form.username class="form-control" %}</div>
    </div>
    <div class="form-group row">
        <div class="col-form-label col-lg-3 text-lg-right">{{ form.password.label_tag}}</div>
        <div class="col-lg-8 col-12">{% render_field form.password class="form-control" %}</div>
    </div>

    <div class="form-group row">
        <div class="col-lg-9 ml-auto">
            <button type="submit" class="btn btn-primary">{% trans "Login" %}</button>
            <a href="{% url 'member-password-reset' %}">{% trans "Forgot password?" %}</a>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-lg-9 ml-auto">
            {% trans "Not a member?" %}
            <a href="{% url 'member-signup' %}">{% trans "Sign Up!" %}</a>
        </div>
    </div>
</form>

{% get_current_language as current_code %}
{% get_available_languages as languages %}

<div class="mb-3 text-center">
    <div class="dropdown" >
        <button class="btn btn-outline-secondary dropdown-toggle" style="min-width: 160px;" type="button" data-toggle="dropdown" aria-expanded="false">
            Language <svg class="ml-1" xmlns="http://www.w3.org/2000/svg" height="20" width="25" viewBox="0 0 640 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="currentcolor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3 0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1 .1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2L179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4c.9 .6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9l-18.9-11.3c-4.5-2.7-8.8-5.5-13.1-8.5c-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8l-12.2-12.2c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6 .5 .5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg>
        </button>
        <div class="dropdown-menu">
            {% for code, _ in LANGUAGES %}
            {% if code != current_code %}
            <form action="{% url 'set_language' %}" method="post" class="dropdown-item">
                {% csrf_token %}
                <input name="language" type="hidden" value="{{ code }}">
                <input type="submit" class="lang-input" value="{{ code | language_name_local }}{% if '-' in code %} ({{ code | slice:'3:' | upper }}){% endif %}">
            </form>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<div>
    {% url 'help-band-request' as band_request_url %}
    {% blocktrans %}Want your band on the Gig-o? Click <a href="{{ band_request_url }}">here</a>.{% endblocktrans %}
    {% url 'help-whatis' as whatis_url %}
    {% blocktrans %}What is the Gig-o-Matic, anyway? Click <a href="{{ whatis_url }}">here</a>!{% endblocktrans %}
</div>
{% endblock pagecontent %}
