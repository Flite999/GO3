{% extends 'base/go3base.html' %}
{% load i18n %}
{% load static %}

{% block headcontent %}
        <!-- Custom styles for calendar -->
        <link href='/static/fullcalendar/lib/main.css' rel='stylesheet' />
        <link href='/fullcalendar/fullcalendar.print.css' rel='stylesheet' media='print' />
{% endblock headcontent %}


{% block title %}{% trans "Calendar"%}{% endblock title %}

{% block content %}
    <div class="row">
        <div class="page-header page-header mx-auto col-md-10 col-12">
            {% trans "Calendar" %}
            {% if the_user.preferences.default_view != 1 %}
            <small>(<a href="/?default=1">{% trans "Make this my default view!" %}</a>)</small>
            {% endif %}
        </div>
    </div>
    <div class="row">
        <div class="mx-auto col-md-10 col-12">
            <div id='calendar'></div>
        </div>
    </div>
{% endblock content %}

{% block localscripts %}
    <script src='{% static "fullcalendar/lib/main.js" %}'></script>
    {% if user.preferences.language != "en" %}
        <script src='{% static "fullcalendar/lib/locales/"|add:user.preferences.language|add:".js" %}'></script>
    {% endif %}
    <script>

    function calCallback(view) {
        mo = $('#calendar').fullCalendar('getDate')
        var stateObj = { foo: "bar" };
        window.history.replaceState(stateObj, "", window.location.origin+window.location.pathname+"?y="+mo.year()+"&m="+mo.month());
    }

    $(document).ready(function() {
        // page is now ready, initialize the calendar...
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            // put your options and callbacks here
            themeSystem: 'bootstrap',
            locale: '{{ user.preferences.language }}'
            // events: {
            //     url: '/calevents',
            //     type: 'POST',
            //     data: {
            //         mk: '{{ user.id }}'
            //     },
            //     error: function() {
            //         alert('there was an error while fetching events!');
            //     },
            // },
            // eventAfterAllRender: calCallback,
        });
        calendar.render();
    });
    </script>
{% endblock localscripts %}

